{"version":3,"sources":["webpack:///2.js","webpack:///./www/src/js/input-file.js","webpack:///./www/src/js/input-file/error-messages-template.html","webpack:///./www/src/js/input-file/progress-template.html","webpack:///./www/src/js/input-file/upload-template.html","webpack:///./www/src/js/input-file/value-template.html","webpack:///./www/src/js/input-file/upload-view.js"],"names":["webpackJsonp","130","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__input_file_upload_view__","InputFile","selector","arguments","length","undefined","this","$","each","index","button","input","view","data","val","url","setValueInput","setFileThumbnail","setFileUrl","renderFileValue","document","on","e","preventDefault","setFileInputName","setActionUrl","body","appendChild","render","el","149","exports","150","151","152","167","__WEBPACK_IMPORTED_MODULE_0__upload_template_html__","__WEBPACK_IMPORTED_MODULE_0__upload_template_html___default","n","__WEBPACK_IMPORTED_MODULE_1__value_template_html__","__WEBPACK_IMPORTED_MODULE_1__value_template_html___default","__WEBPACK_IMPORTED_MODULE_2__progress_template_html__","__WEBPACK_IMPORTED_MODULE_2__progress_template_html___default","__WEBPACK_IMPORTED_MODULE_3__error_messages_template_html__","__WEBPACK_IMPORTED_MODULE_3__error_messages_template_html___default","uploadTemplate","_","template","a","valueTemplate","progressTemplate","errorMessagesTemplate","UploadView","Backbone","View","extend","events","change input","$valueInput","$wrapper","parent","fileInputName","fileThumbnail","fileUrl","actionUrl","$el","html","find","click","thumbnail","clearStatusUi","append","bind","renderErrorMessages","messages","renderProgressBar","remove","handleFileSelected","files","target","FormData","file","attr","ajax","type","cache","dataType","processData","contentType","success","response","result","trigger","error"],"mappings":"AAAAA,cAAc,IAERC,IACA,SAAUC,EAAQC,EAAqBC,GAE7C,YAGA,SAASC,iBAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhHC,OAAOC,eAAeP,EAAqB,cAAgBQ,OAAO,GAC7C,IAAIC,GAAwDR,EAAoB,KCL/FS,EACF,QAAAA,aAA0C,GAA9BC,GAA8BC,UAAAC,QAAA,OAAAC,KAAAF,UAAA,GAAnB,kBAAmBA,UAAA,EAAAV,iBAAAa,KAAAL,WACjCC,EAASE,SACVF,EAAW,mBAIfK,EAAEL,GAAUM,KACR,SAAUC,EAAOC,GACb,GAAIC,GACAC,EAAO,GAAIZ,GAAA,CAKf,IAHAU,EAASH,EAAEG,GACXC,EAASJ,EAAEG,EAAOG,KAAK,gBAEnBF,EAAMG,MAAO,CACb,GAAIC,GAAMJ,EAAMG,KACZJ,GAAOG,KAAK,cACZE,EAAML,EAAOG,KAAK,aAGtBD,EACKI,cAAcL,GACdM,iBAAiBP,EAAOG,KAAK,mBAC7BK,WAAWR,EAAOG,KAAK,aACvBM,gBAAgBJ,EAAKL,EAAOG,KAAK,sBAMlDN,EAAEa,UAAUC,GACR,QACAnB,EACA,SAAUoB,GACN,GAAIV,GAAS,GAAIZ,GAAA,EACbU,EAASH,EAAED,KAEfgB,GAAEC,iBAEFX,EACKI,cAAcT,EAAEG,EAAOG,KAAK,iBAC5BW,iBAAiBd,EAAOG,KAAK,oBAC7BY,aAAaf,EAAOG,KAAK,eAE9BO,SAASM,KAAKC,YAAYf,EAAKgB,SAASC,MAMxDtC,GAAA,WDGMuC,IACA,SAAUxC,EAAQyC,GEzDxBzC,EAAOyC,QAAU,0NF+DXC,IACA,SAAU1C,EAAQyC,GGhExBzC,EAAOyC,QAAU,uYHsEXE,IACA,SAAU3C,EAAQyC,GIvExBzC,EAAOyC,QAAU,6LJ6EXG,IACA,SAAU5C,EAAQyC,GK9ExBzC,EAAOyC,QAAU,kpCLoFXI,IACA,SAAU7C,EAAQC,EAAqBC,GAE7C,YACqB,IAAI4C,GAAsD5C,EAAoB,KAC1E6C,EAA8D7C,EAAoB8C,EAAEF,GACpFG,EAAqD/C,EAAoB,KACzEgD,EAA6DhD,EAAoB8C,EAAEC,GACnFE,EAAwDjD,EAAoB,KAC5EkD,EAAgElD,EAAoB8C,EAAEG,GACtFE,EAA8DnD,EAAoB,KAClFoD,EAAsEpD,EAAoB8C,EAAEK,GM1FjHE,EAAwBC,EAAEC,SAASV,EAAAW,GACnCC,EAAwBH,EAAEC,SAASP,EAAAQ,GACnCE,EAAwBJ,EAAEC,SAASL,EAAAM,GACnCG,EAAwBL,EAAEC,SAASH,EAAAI,GAEnCI,EAAaC,SAASC,KAAKC,QAC3BC,QACIC,eAAgB,sBAGpBzC,cAAe,SAAU0C,GAIrB,MAHApD,MAAKoD,YAAcA,EACnBpD,KAAKqD,SAAcD,EAAYE,SAExBtD,MAGXkB,iBAAkB,SAAUqC,GAGxB,MAFAvD,MAAKuD,cAAgBA,EAEdvD,MAGXW,iBAAkB,SAAU6C,GAExB,MADAxD,MAAKwD,cAAgBA,EACdxD,MAGXY,WAAY,SAAU6C,GAElB,MADAzD,MAAKyD,QAAUA,EACRzD,MAGXmB,aAAc,SAASuC,GAGnB,MAFA1D,MAAK0D,UAAYA,EAEV1D,MAGXsB,OAAQ,WAWJ,GAVAtB,KAAK2D,IAAIC,KACLrB,GAEQgB,cAAevD,KAAKuD,iBAKhCvD,KAAK2D,IAAIE,KAAK,SAASC,QAEnB9D,KAAKoD,YAAY5C,MAAO,CACxB,GAAIC,GAAMT,KAAKoD,YAAY5C,KACvBR,MAAKyD,UACLhD,EAAMT,KAAKyD,SAGfzD,KAAKa,gBAAgBJ,EAAKT,KAAKwD,eAGnC,MAAOxD,OAGXa,gBAAiB,SAAUJ,EAAKsD,GAC5B/D,KAAKgE,gBAGLhE,KAAKqD,SAASQ,KAAK,kBAAkBI,OACjCtB,GAEQlC,IAAKA,EACLsD,UAAWA,KAKvB/D,KAAKqD,SAAStC,GACV,QACA,cACAyB,EAAE0B,KACE,SAAUlD,GACNA,EAAEC,iBACFjB,KAAKoD,YAAY5C,IAAI,IACrBR,KAAKgE,iBAEThE,OAIRA,KAAKqD,SAAStC,GACV,QACA,YACAyB,EAAE0B,KACE,SAAUlD,GACNA,EAAEC,iBACFjB,KAAKoD,YAAY5C,IAAI,KAEzBR,QAKZmE,oBAAqB,SAAUC,GAC3BpE,KAAKgE,gBAELhE,KAAKqD,SAASY,OACVpB,GAEQuB,SAAUA,MAM1BC,kBAAmB,WACfrE,KAAKgE,gBAELhE,KAAKqD,SAASQ,KAAK,kBAAkBI,OACjCrB,QAQRoB,cAAe,WACXhE,KAAKqD,SAASQ,KAAK,yBAAyBS,UAGhDC,mBAAoB,SAAUvD,GAC1B,GAAIwD,GAAQxD,EAAEyD,OAAOD,MACjBjE,EAAQ,GAAImE,SAEhBlC,GAAEtC,KACEsE,EACA,SAAUG,GACNpE,EAAK0D,OAAOjE,KAAK2D,IAAIE,KAAK,SAASe,KAAK,QAASD,IAErD3E,MAGJA,KAAKqE,oBAELpE,EAAE4E,MACEpE,IAAKT,KAAK0D,UACVoB,KAAM,OACNvE,KAAMA,EACNwE,OAAO,EACPC,SAAU,OACVC,aAAa,EACbC,aAAa,EACbC,QAAS3C,EAAE0B,KACP,SAAUkB,GACDA,GAAY,YAAcA,EAASC,QAGpCrF,KAAKoD,YAAY5C,IAAI4E,EAAS3F,OAAO6F,QAAQ,UAE7CtF,KAAKa,gBAAgBuE,EAAS3E,IAAK2E,EAASrB,YAJ5C/D,KAAKmE,oBAAoBiB,EAAShB,WAO1CpE,MAEJuF,MAAO/C,EAAE0B,KACL,WACIlE,KAAKmE,qBACA,wEAGTnE,UAMhBf,GAAA","file":"2.js","sourcesContent":["webpackJsonp([2],{\n\n/***/ 130:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__input_file_upload_view__ = __webpack_require__(167);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar InputFile = function InputFile() {\n    var selector = arguments.length <= 0 || arguments[0] === undefined ? '.btn-input-file' : arguments[0];\n\n    _classCallCheck(this, InputFile);\n\n    if (!selector.length) {\n        selector = '.btn-input-file';\n    }\n\n    // Render initial input state\n    $(selector).each(function (index, button) {\n        var input,\n            view = new __WEBPACK_IMPORTED_MODULE_0__input_file_upload_view__[\"a\" /* default */]();\n\n        button = $(button);\n        input = $(button.data('value-input'));\n\n        if (input.val()) {\n            var url = input.val();\n            if (button.data('file-url')) {\n                url = button.data('file-url');\n            }\n\n            view.setValueInput(input).setFileThumbnail(button.data('file-thumbnail')).setFileUrl(button.data('file-url')).renderFileValue(url, button.data('file-thumbnail'));\n        }\n    });\n\n    // Handle attempt to upload a file\n    $(document).on('click', selector, function (e) {\n        var view = new __WEBPACK_IMPORTED_MODULE_0__input_file_upload_view__[\"a\" /* default */](),\n            button = $(this);\n\n        e.preventDefault();\n\n        view.setValueInput($(button.data('value-input'))).setFileInputName(button.data('file-input-name')).setActionUrl(button.data('action-url'));\n\n        document.body.appendChild(view.render().el);\n    });\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (InputFile);\n\n/***/ }),\n\n/***/ 149:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <div class=\\\"alert alert-danger\\\" role=\\\"alert\\\">\\n        <% _.each(messages, function (message) { %>\\n        <div><%- message %></div>\\n        <% }); %>\\n    </div>\\n</div>\\n\";\n\n/***/ }),\n\n/***/ 150:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <div class=\\\"progress\\\">\\n        <div class=\\\"progress-bar progress-bar-striped active\\\" role=\\\"progressbar\\\" aria-valuenow=\\\"45\\\" aria-valuemin=\\\"0\\\" aria-valuemax=\\\"100\\\" style=\\\"width: 100%\\\">\\n            <span class=\\\"sr-only\\\">Loading...</span>\\n        </div>\\n    </div>\\n    <div class=\\\"progress-text text-muted\\\">Loading.  Please wait...</div>\\n</div>\\n\";\n\n/***/ }),\n\n/***/ 151:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<form class=\\\"input-file-upload-form\\\" enctype=\\\"multipart/form-data\\\" action=\\\"\\\" method=\\\"POST\\\">\\n    <input class=\\\"input-file-uploader\\\" type=\\\"file\\\" name=\\\"<%- fileInputName %>\\\" />\\n</form>\\n\";\n\n/***/ }),\n\n/***/ 152:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <% if (thumbnail) { %>\\n    <div class=\\\"panel panel-default\\\">\\n        <div class=\\\"panel-body\\\">\\n            <a target=\\\"_blank\\\" href=\\\"<%- url %>\\\">\\n                <div class=\\\"thumbnail\\\">\\n                    <img src=\\\"<%- thumbnail %>\\\" />\\n                </div>\\n\\n                <span class=\\\"glyphicon glyphicon-file\\\"></span>\\n                <%- url.split('/').pop() %>\\n            </a>\\n        </div>\\n    </div>\\n    <% } else { %>\\n    <a target=\\\"_blank\\\" href=\\\"<%- url %>\\\">\\n        <span class=\\\"glyphicon glyphicon-file\\\"></span>\\n        <%- url.split('/').pop() %>\\n    </a>\\n    <% } %>\\n\\n\\n    <div class=\\\"btn-group btn-group-justified\\\" role=\\\"group\\\">\\n        <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n            <button type=\\\"button\\\" class=\\\"btn btn-default btn-xs btn-remove\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove</button>\\n        </div>\\n        <!--\\n        <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n            <button type=\\\"button\\\" class=\\\"btn btn-default btn-xs btn-copy\\\"><span class=\\\"glyphicon glyphicon-copy\\\"></span> Copy</button>\\n        </div>\\n        -->\\n    </div>\\n</div>\\n\";\n\n/***/ }),\n\n/***/ 167:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__upload_template_html__ = __webpack_require__(151);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__upload_template_html___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__upload_template_html__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__value_template_html__ = __webpack_require__(152);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__value_template_html___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__value_template_html__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__progress_template_html__ = __webpack_require__(150);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__progress_template_html___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__progress_template_html__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__error_messages_template_html__ = __webpack_require__(149);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__error_messages_template_html___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__error_messages_template_html__);\n\n\n\n\n\nvar uploadTemplate = _.template(__WEBPACK_IMPORTED_MODULE_0__upload_template_html___default.a),\n    valueTemplate = _.template(__WEBPACK_IMPORTED_MODULE_1__value_template_html___default.a),\n    progressTemplate = _.template(__WEBPACK_IMPORTED_MODULE_2__progress_template_html___default.a),\n    errorMessagesTemplate = _.template(__WEBPACK_IMPORTED_MODULE_3__error_messages_template_html___default.a);\n\nvar UploadView = Backbone.View.extend({\n    events: {\n        'change input': 'handleFileSelected'\n    },\n\n    setValueInput: function setValueInput($valueInput) {\n        this.$valueInput = $valueInput;\n        this.$wrapper = $valueInput.parent();\n\n        return this;\n    },\n\n    setFileInputName: function setFileInputName(fileInputName) {\n        this.fileInputName = fileInputName;\n\n        return this;\n    },\n\n    setFileThumbnail: function setFileThumbnail(fileThumbnail) {\n        this.fileThumbnail = fileThumbnail;\n        return this;\n    },\n\n    setFileUrl: function setFileUrl(fileUrl) {\n        this.fileUrl = fileUrl;\n        return this;\n    },\n\n    setActionUrl: function setActionUrl(actionUrl) {\n        this.actionUrl = actionUrl;\n\n        return this;\n    },\n\n    render: function render() {\n        this.$el.html(uploadTemplate({\n            fileInputName: this.fileInputName\n        }));\n\n        this.$el.find('input').click();\n\n        if (this.$valueInput.val()) {\n            var url = this.$valueInput.val();\n            if (this.fileUrl) {\n                url = this.fileUrl;\n            }\n\n            this.renderFileValue(url, this.fileThumbnail);\n        }\n\n        return this;\n    },\n\n    renderFileValue: function renderFileValue(url, thumbnail) {\n        this.clearStatusUi();\n\n        // @todo Refactor value UI into a sub-view so we can use Backbone event delegation for the buttons\n        this.$wrapper.find('.value-wrapper').append(valueTemplate({\n            url: url,\n            thumbnail: thumbnail\n        }));\n\n        this.$wrapper.on('click', '.btn-remove', _.bind(function (e) {\n            e.preventDefault();\n            this.$valueInput.val('');\n            this.clearStatusUi();\n        }, this));\n\n        this.$wrapper.on('click', '.btn-copy', _.bind(function (e) {\n            e.preventDefault();\n            this.$valueInput.val('');\n        }, this));\n    },\n\n    renderErrorMessages: function renderErrorMessages(messages) {\n        this.clearStatusUi();\n\n        this.$wrapper.append(errorMessagesTemplate({\n            messages: messages\n        }));\n    },\n\n    renderProgressBar: function renderProgressBar() {\n        this.clearStatusUi();\n\n        this.$wrapper.find('.value-wrapper').append(progressTemplate({}));\n    },\n\n    clearStatusUi: function clearStatusUi() {\n        this.$wrapper.find('.input-file-status-ui').remove();\n    },\n\n    handleFileSelected: function handleFileSelected(e) {\n        var files = e.target.files,\n            data = new FormData();\n\n        _.each(files, function (file) {\n            data.append(this.$el.find('input').attr('name'), file);\n        }, this);\n\n        this.renderProgressBar();\n\n        $.ajax({\n            url: this.actionUrl,\n            type: 'POST',\n            data: data,\n            cache: false,\n            dataType: 'json',\n            processData: false,\n            contentType: false,\n            success: _.bind(function (response) {\n                if (!response || 'success' !== response.result) {\n                    this.renderErrorMessages(response.messages);\n                } else {\n                    this.$valueInput.val(response.value).trigger('change');\n\n                    this.renderFileValue(response.url, response.thumbnail);\n                }\n            }, this),\n            error: _.bind(function () {\n                this.renderErrorMessages(['There was an error uploading the selected file.  Please try again.']);\n            }, this)\n        });\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (UploadView);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 2.js","import UploadView from './input-file/upload-view';\n\nclass InputFile {\n    constructor(selector = '.btn-input-file') {\n        if (!selector.length) {\n            selector = '.btn-input-file'\n        }\n\n        // Render initial input state\n        $(selector).each(\n            function (index, button) {\n                var input,\n                    view = new UploadView();\n\n                button = $(button);\n                input  = $(button.data('value-input'));\n\n                if (input.val()) {\n                    var url = input.val();\n                    if (button.data('file-url')) {\n                        url = button.data('file-url');\n                    }\n\n                    view\n                        .setValueInput(input)\n                        .setFileThumbnail(button.data('file-thumbnail'))\n                        .setFileUrl(button.data('file-url'))\n                        .renderFileValue(url, button.data('file-thumbnail'));\n                }\n            }\n        );\n\n        // Handle attempt to upload a file\n        $(document).on(\n            'click',\n            selector,\n            function (e) {\n                var view   = new UploadView(),\n                    button = $(this);\n\n                e.preventDefault();\n\n                view\n                    .setValueInput($(button.data('value-input')))\n                    .setFileInputName(button.data('file-input-name'))\n                    .setActionUrl(button.data('action-url'));\n\n                document.body.appendChild(view.render().el);\n            }\n        );\n    }\n}\n\nexport default InputFile;\n\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file.js","module.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <div class=\\\"alert alert-danger\\\" role=\\\"alert\\\">\\n        <% _.each(messages, function (message) { %>\\n        <div><%- message %></div>\\n        <% }); %>\\n    </div>\\n</div>\\n\"\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file/error-messages-template.html","module.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <div class=\\\"progress\\\">\\n        <div class=\\\"progress-bar progress-bar-striped active\\\" role=\\\"progressbar\\\" aria-valuenow=\\\"45\\\" aria-valuemin=\\\"0\\\" aria-valuemax=\\\"100\\\" style=\\\"width: 100%\\\">\\n            <span class=\\\"sr-only\\\">Loading...</span>\\n        </div>\\n    </div>\\n    <div class=\\\"progress-text text-muted\\\">Loading.  Please wait...</div>\\n</div>\\n\"\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file/progress-template.html","module.exports = \"<form class=\\\"input-file-upload-form\\\" enctype=\\\"multipart/form-data\\\" action=\\\"\\\" method=\\\"POST\\\">\\n    <input class=\\\"input-file-uploader\\\" type=\\\"file\\\" name=\\\"<%- fileInputName %>\\\" />\\n</form>\\n\"\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file/upload-template.html","module.exports = \"<div class=\\\"input-file-status-ui\\\">\\n    <% if (thumbnail) { %>\\n    <div class=\\\"panel panel-default\\\">\\n        <div class=\\\"panel-body\\\">\\n            <a target=\\\"_blank\\\" href=\\\"<%- url %>\\\">\\n                <div class=\\\"thumbnail\\\">\\n                    <img src=\\\"<%- thumbnail %>\\\" />\\n                </div>\\n\\n                <span class=\\\"glyphicon glyphicon-file\\\"></span>\\n                <%- url.split('/').pop() %>\\n            </a>\\n        </div>\\n    </div>\\n    <% } else { %>\\n    <a target=\\\"_blank\\\" href=\\\"<%- url %>\\\">\\n        <span class=\\\"glyphicon glyphicon-file\\\"></span>\\n        <%- url.split('/').pop() %>\\n    </a>\\n    <% } %>\\n\\n\\n    <div class=\\\"btn-group btn-group-justified\\\" role=\\\"group\\\">\\n        <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n            <button type=\\\"button\\\" class=\\\"btn btn-default btn-xs btn-remove\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span> Remove</button>\\n        </div>\\n        <!--\\n        <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n            <button type=\\\"button\\\" class=\\\"btn btn-default btn-xs btn-copy\\\"><span class=\\\"glyphicon glyphicon-copy\\\"></span> Copy</button>\\n        </div>\\n        -->\\n    </div>\\n</div>\\n\"\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file/value-template.html","import templateHtml from './upload-template.html';\nimport valueTemplateHtml from './value-template.html';\nimport progressTemplateHtml from './progress-template.html';\nimport errorMessagesTemplateHtml from './error-messages-template.html';\n\nvar uploadTemplate        = _.template(templateHtml),\n    valueTemplate         = _.template(valueTemplateHtml),\n    progressTemplate      = _.template(progressTemplateHtml),\n    errorMessagesTemplate = _.template(errorMessagesTemplateHtml);\n\nvar UploadView = Backbone.View.extend({\n    events: {\n        'change input': 'handleFileSelected'\n    },\n\n    setValueInput: function ($valueInput) {\n        this.$valueInput = $valueInput;\n        this.$wrapper    = $valueInput.parent();\n\n        return this;\n    },\n\n    setFileInputName: function (fileInputName) {\n        this.fileInputName = fileInputName;\n\n        return this;\n    },\n\n    setFileThumbnail: function (fileThumbnail) {\n        this.fileThumbnail = fileThumbnail;\n        return this;\n    },\n\n    setFileUrl: function (fileUrl) {\n        this.fileUrl = fileUrl;\n        return this;\n    },\n\n    setActionUrl: function(actionUrl) {\n        this.actionUrl = actionUrl;\n\n        return this;\n    },\n\n    render: function () {\n        this.$el.html(\n            uploadTemplate(\n                {\n                    fileInputName: this.fileInputName\n                }\n            )\n        );\n\n        this.$el.find('input').click();\n\n        if (this.$valueInput.val()) {\n            var url = this.$valueInput.val();\n            if (this.fileUrl) {\n                url = this.fileUrl;\n            }\n\n            this.renderFileValue(url, this.fileThumbnail);\n        }\n\n        return this;\n    },\n\n    renderFileValue: function (url, thumbnail) {\n        this.clearStatusUi();\n\n        // @todo Refactor value UI into a sub-view so we can use Backbone event delegation for the buttons\n        this.$wrapper.find('.value-wrapper').append(\n            valueTemplate(\n                {\n                    url: url,\n                    thumbnail: thumbnail\n                }\n            )\n        );\n\n        this.$wrapper.on(\n            'click',\n            '.btn-remove',\n            _.bind(\n                function (e) {\n                    e.preventDefault();\n                    this.$valueInput.val('');\n                    this.clearStatusUi();\n                },\n                this\n            )\n        );\n\n        this.$wrapper.on(\n            'click',\n            '.btn-copy',\n            _.bind(\n                function (e) {\n                    e.preventDefault();\n                    this.$valueInput.val('');\n                },\n                this\n            )\n        );\n    },\n\n    renderErrorMessages: function (messages) {\n        this.clearStatusUi();\n\n        this.$wrapper.append(\n            errorMessagesTemplate(\n                {\n                    messages: messages\n                }\n            )\n        )\n    },\n\n    renderProgressBar: function () {\n        this.clearStatusUi();\n\n        this.$wrapper.find('.value-wrapper').append(\n            progressTemplate(\n                {\n\n                }\n            )\n        );\n    },\n\n    clearStatusUi: function () {\n        this.$wrapper.find('.input-file-status-ui').remove();\n    },\n\n    handleFileSelected: function (e) {\n        var files = e.target.files,\n            data  = new FormData();\n\n        _.each(\n            files,\n            function (file) {\n                data.append(this.$el.find('input').attr('name'), file);\n            },\n            this\n        );\n\n        this.renderProgressBar();\n\n        $.ajax({\n            url: this.actionUrl,\n            type: 'POST',\n            data: data,\n            cache: false,\n            dataType: 'json',\n            processData: false,\n            contentType: false,\n            success: _.bind(\n                function (response) {\n                    if (!response || 'success' !== response.result) {\n                        this.renderErrorMessages(response.messages);\n                    } else {\n                        this.$valueInput.val(response.value).trigger('change');\n\n                        this.renderFileValue(response.url, response.thumbnail);\n                    }\n                },\n                this\n            ),\n            error: _.bind(\n                function () {\n                    this.renderErrorMessages(\n                        ['There was an error uploading the selected file.  Please try again.']\n                    );\n                },\n                this\n            )\n        });\n    }\n});\n\nexport default UploadView;\n\n\n\n// WEBPACK FOOTER //\n// ./www/src/js/input-file/upload-view.js"],"sourceRoot":""}